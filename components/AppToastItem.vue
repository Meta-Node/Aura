<template>
  <div class="toast" :class="'toast--' + toast.color">
    <div ref="progress" class="toast__progress"></div>
    <div class="toast__message">{{ toast.text }}</div>
    <button class="toast__close" @click.prevent="hide(toast.id)">
      <svg
        width="15"
        height="14"
        viewBox="0 0 15 14"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M0.591241 0.35617C0.809803 0.137454 1.1062 0.0145854 1.41524 0.0145854C1.72429 0.0145854 2.02069 0.137454 2.23925 0.35617L7.24271 5.36467L12.2462 0.35617C12.3537 0.244741 12.4823 0.155862 12.6245 0.094718C12.7667 0.0335742 12.9196 0.00139017 13.0744 4.40499e-05C13.2291 -0.00130207 13.3826 0.0282163 13.5258 0.0868774C13.6691 0.145538 13.7992 0.232167 13.9086 0.341709C14.0181 0.45125 14.1046 0.581511 14.1632 0.72489C14.2218 0.868269 14.2513 1.0219 14.25 1.1768C14.2486 1.33171 14.2165 1.4848 14.1554 1.62714C14.0943 1.76948 14.0055 1.89821 13.8942 2.00584L8.89072 7.01434L13.8942 12.0228C14.1065 12.2429 14.224 12.5376 14.2213 12.8435C14.2187 13.1494 14.0961 13.442 13.88 13.6583C13.6639 13.8746 13.3716 13.9973 13.066 14C12.7604 14.0026 12.466 13.885 12.2462 13.6725L7.24271 8.664L2.23925 13.6725C2.01943 13.885 1.72503 14.0026 1.41944 14C1.11385 13.9973 0.82153 13.8746 0.605438 13.6583C0.389346 13.442 0.266772 13.1494 0.264117 12.8435C0.261461 12.5376 0.378937 12.2429 0.591241 12.0228L5.59471 7.01434L0.591241 2.00584C0.372745 1.78705 0.25 1.49036 0.25 1.181C0.25 0.871645 0.372745 0.574952 0.591241 0.35617Z"
          fill="#000000"
        />
      </svg>
    </button>
  </div>
</template>

<script>
import gsap from 'gsap'

export default {
  props: {
    toast: {
      type: Object,
      default: () => {},
    },
  },
  beforeMount() {
    setTimeout(() => {
      gsap.to(this.$refs.progress, {
        duration: 5,
        width: '100%',
        ease: 'linear',
        onComplete: () => {
          this.hide(this.toast.id)
        },
      })
    }, 0)
  },
  methods: {
    hide(id) {
      this.$emit('hide', id)
    },
  },
}
</script>